package script

import java.security.spec.AlgorithmParameterSpec
import java.util.*
import javax.crypto.Cipher
import javax.crypto.spec.GCMParameterSpec
import javax.crypto.spec.SecretKeySpec

fun main() {

    // coral uat
    val b64AESKey = "QYE3dDJzgp7Zl2ZF+fYIu9tRxfBq3f6P9kvcQU271kw="
//    val b64AESKey = "oDSCocyqCW8/HETAnU+tsaG4LGMCOHG5pprwiUInVD4="
//    val b64PrivateKey = "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"
    val b64PrivateKey = "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"

    val keyByte = Base64.getDecoder().decode(b64AESKey)
    val cipherText = Base64.getDecoder().decode(b64PrivateKey)
    val secretKey = SecretKeySpec(keyByte, "AES")
    val cipher = Cipher.getInstance("AES/GCM/NoPadding")

    //use first 12 bytes for iv
    val gcmIv: AlgorithmParameterSpec = GCMParameterSpec(128, cipherText, 0, 12)
    cipher.init(Cipher.DECRYPT_MODE, secretKey, gcmIv)

    //use everything from 12 bytes on as ciphertext
    val plainText = cipher.doFinal(cipherText, 12, cipherText.size - 12)
    println(String(plainText))
}